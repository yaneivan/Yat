# HTR Polygon Annotation Tool

–õ–µ–≥–∫–æ–≤–µ—Å–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–∑–º–µ—Ç–∫–∏ —Ä—É–∫–æ–ø–∏—Å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ (HTR/OCR). –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–¥–µ–ª—è—Ç—å —Å—Ç—Ä–æ–∫–∏ —Ç–µ–∫—Å—Ç–∞ –ø–æ–ª–∏–≥–æ–Ω–∞–º–∏, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≥–µ–æ–º–µ—Ç—Ä–∏—é –∏ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
*   **–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è:** –†–∏—Å–æ–≤–∞–Ω–∏–µ —Ç–æ—á–Ω—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤ –≤–æ–∫—Ä—É–≥ —Å—Ç—Ä–æ–∫ —Ç–µ–∫—Å—Ç–∞.
*   **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ **–ø–æ—Ç–æ—á–µ—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤–µ—Ä—à–∏–Ω –ø–æ–ª–∏–≥–æ–Ω–∞.
*   **–ë—ã—Å—Ç—Ä–æ–¥–µ–π—Å—Ç–≤–∏–µ:** SPA-–Ω–∞–≤–∏–≥–∞—Ü–∏—è (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã) –∏ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
*   **–ò—Å—Ç–æ—Ä–∏—è:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ Undo / Redo (`Ctrl+Z`, `Ctrl+Shift+Z`).
*   **–ò–º–ø–æ—Ä—Ç:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ZIP-–∞—Ä—Ö–∏–≤–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–∑ **eScriptorium** (METS + PageXML).
*   **–£–¥–æ–±—Å—Ç–≤–æ:** –ó—É–º –∫–æ–ª–µ—Å–∏–∫–æ–º, –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ (Pan), –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
*   **Backend:** Python 3 + Flask.
*   **Frontend:** Vanilla JS + **Fabric.js** (Canvas rendering).
*   **Storage:** –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (JSON –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏).

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1.  **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Python 3.6+.
2.  **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
    ```bash
    pip install flask
    ```
3.  **–ó–∞–ø—É—Å–∫:**
    ```bash
    python app.py
    ```
4.  –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –ø–æ –∞–¥—Ä–µ—Å—É: `http://127.0.0.1:5000`

## ‚å®Ô∏è –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏

| –ö–ª–∞–≤–∏—à–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
| --- | --- |
| **N** | –†–µ–∂–∏–º —Ä–∏—Å–æ–≤–∞–Ω–∏—è (Draw) |
| **V** | –†–µ–∂–∏–º –≤—ã–¥–µ–ª–µ–Ω–∏—è (Select/Edit) |
| **P** | –†–µ–∂–∏–º –ø—Ä–∞–≤–∫–∏ —Ç–æ—á–µ–∫ (Edit Points) |
| **Del** | –£–¥–∞–ª–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ |
| **Esc** | –û—Ç–º–µ–Ω–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è / –°–±—Ä–æ—Å –≤—ã–¥–µ–ª–µ–Ω–∏—è |
| **Ctrl + Z** | –û—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ (Undo) |
| **Ctrl + Shift + Z** | –í–µ—Ä–Ω—É—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ (Redo) |
| **Ctrl + A** | –í—ã–¥–µ–ª–∏—Ç—å –≤—Å–µ –ø–æ–ª–∏–≥–æ–Ω—ã |
| **Ctrl + ‚Üê / ‚Üí** | –ü—Ä–µ–¥—ã–¥—É—â–µ–µ / –°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ |
| **–ü–ö–ú** (–∏–ª–∏ Alt+Drag) | –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ö–æ–ª—Å—Ç–∞ (Pan) |
| **–ö–æ–ª–µ—Å–æ –º—ã—à–∏** | –ó—É–º (Zoom) |

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
htr_tool/
‚îú‚îÄ‚îÄ app.py                # Flask –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (—Ä–æ—É—Ç–∏–Ω–≥)
‚îú‚îÄ‚îÄ utils.py              # –õ–æ–≥–∏–∫–∞: —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏, XML –ø–∞—Ä—Å–∏–Ω–≥, –∏–º–ø–æ—Ä—Ç
‚îú‚îÄ‚îÄ data/                 # –•—Ä–∞–Ω–∏–ª–∏—â–µ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ images/           # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ annotations/      # JSON —Ñ–∞–π–ª—ã —Ä–∞–∑–º–µ—Ç–∫–∏
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îú‚îÄ‚îÄ css/style.css     # –°—Ç–∏–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ js/
‚îÇ       ‚îú‚îÄ‚îÄ api.js        # API –∫–ª–∏–µ–Ω—Ç
‚îÇ       ‚îú‚îÄ‚îÄ editor.js     # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∏ –∏—Å—Ç–æ—Ä–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ dashboard.js  # –õ–æ–≥–∏–∫–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îî‚îÄ‚îÄ templates/            # HTML —à–∞–±–ª–æ–Ω—ã
```

## üìÑ –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö
–†–∞–∑–º–µ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫—É `data/annotations/` –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:
```json
{
    "image": "filename.jpg",
    "regions": [
        {
            "points": [
                {"x": 100, "y": 100},
                {"x": 200, "y": 100},
                {"x": 200, "y": 150},
                {"x": 100, "y": 150}
            ]
        }
    ]
}
```