<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>HTR Editor</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
</head>
<body>

<div id="toolbar">
    <button class="btn" onclick="window.location.href='/'" title="Home">üè†</button>
    <div class="sep"></div>
    <button class="btn" onclick="editor.goImage(-1)">&lt;</button>
    <button class="btn" onclick="editor.goImage(1)">&gt;</button>
    
    <!-- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω class="file-info" -->
    <span class="file-info" style="font-size:0.9em; color:#aaa; max-width:200px; overflow:hidden; white-space:nowrap;">{{ filename }}</span>
    
    <div style="flex:1"></div>

    <button class="btn" onclick="window.location.href='/text_editor?image={{ filename }}'" title="–†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞">üî§ –¢–µ–∫—Å—Ç</button>
    <div class="sep"></div>
    <button class="btn" id="btn-edit" onclick="editor.setMode('edit')">–í—ã–¥–µ–ª–µ–Ω–∏–µ (V)</button>
    <button class="btn" id="btn-draw" onclick="editor.setMode('draw')">–†–∏—Å–æ–≤–∞—Ç—å (N)</button>
    <div class="sep"></div>
    <button class="btn" id="btn-detect" onclick="editor.detectTextLines()">–ê–≤—Ç–æ-—Ä–∞–∑–º–µ—Ç–∫–∞</button>
    <button class="btn" id="btn-detect-settings" onclick="editor.showDetectionSettings()">‚öôÔ∏è</button>
    <div class="sep"></div>
    <button class="btn disabled" id="btn-edit-points" onclick="editor.toggleEditPoints()">–¢–æ—á–∫–∏ (P)</button>
    <button class="btn danger disabled" id="btn-delete" onclick="editor.deleteSelected()">–£–¥–∞–ª–∏—Ç—å (Del)</button>
    <div class="sep"></div>
    <span id="status" style="font-size:0.8em; color:#888; min-width:80px; text-align:right;"></span>
</div>

<div id="workspace" oncontextmenu="return false;">
    <canvas id="c"></canvas>
    <div class="help-overlay">–ü–ö–ú: –ü–∞–Ω | –ö–æ–ª–µ—Å–æ: –ó—É–º | ESC: –û—Ç–º–µ–Ω–∞ | –ö–ª–∏–∫ –≤ –Ω–∞—á–∞–ª–æ: –ó–∞–º–∫–Ω—É—Ç—å | Ctrl+A: –í—Å—ë</div>
</div>

<script src="/static/js/api.js"></script>
<script src="/static/js/editor.js"></script>
<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    const editor = new HTREditor('c', "{{ filename }}");
</script>
</body>
</html>